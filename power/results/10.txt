BEGIN;
BEGIN
select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= date '1993-08-01'
	and o_orderdate < cast(date '1993-08-01' + interval '3 month' as date)
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
 c_custkey |       c_name       |     revenue      | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                     c_comment                                                      
-----------+--------------------+------------------+-----------+---------------------------+------------------------------------------+-----------------+--------------------------------------------------------------------------------------------------------------------
  12667315 | Customer#012667315 |  906576.80120955 |   7678.64 | BRAZIL                    | 0vjju LJxvlWhZi8DKlxGafelta              | 12-653-299-3515 | st carefully slyly unusual deposits. car
  11754884 | Customer#011754884 | 876877.072459657 |   3047.02 | MOZAMBIQUE                | 8jLJvGnIdKMVy5UHbRkvv9P                  | 26-903-454-1868 | dependencies across the blithely pending
  13967080 | Customer#013967080 | 855607.393569212 |   -826.73 | KENYA                     | OFlkOMpn6yeiHGQ42yV                      | 24-170-381-3976 | riously even requests. furiously even courts cajole quickly. carefully bol
   1677172 | Customer#001677172 | 824877.476854887 |   7248.44 | PERU                      | dJBWehOIQ6OXIe4aSP4Qp9Zl6EagOOZWpqoh2ghZ | 27-756-235-1141 | . packages after the carefully final requests haggle carefully against th
   8728522 | Customer#008728522 | 817350.815151159 |    874.35 | ROMANIA                   | lFBNuGHP6WS2YTX9OUBghvzkoFk              | 29-800-823-6539 |  carefully alongside of the final foxes? carefully regular requests above the bold, final inst
  12369226 | Customer#012369226 | 811942.782525887 |   2238.12 | MOROCCO                   | YyOtlCBsb69lt4DpYpNF                     | 25-647-691-2884 | dolites. regular theodolites after the carefully pending asymptotes are slyly even account
   6177169 | Customer#006177169 |  808519.65073188 |   1689.49 | ARGENTINA                 | qSYIbBxvhk9AGIY                          | 11-424-485-9420 | nto beans sleep. accounts haggle furiously u
  10033870 | Customer#010033870 | 798706.298873208 |    585.35 | UNITED STATES             | 8M2X6xOJV1ssmpBz                         | 34-491-278-4488 |  requests boost quickly after the special, pending 
   9915349 | Customer#009915349 | 779586.090750979 |   8731.84 | MOZAMBIQUE                |  sKGFe6QT4Y9L,CX05,m8QQYe,ve3iQSIkd2ks   | 26-404-642-3582 | to beans detect slyly. furiously silent packages against
  12088078 | Customer#012088078 |  779081.90668593 |   4944.55 | IRAN                      | jQ2dwnfUy1AtHAN34b,8GWfN5uuWQesOXlPRyAi  | 20-142-253-7022 | uriously even foxes should have to haggle across the slyly regular deposits. carefully
   4863991 | Customer#004863991 |  778405.42730754 |   8752.83 | UNITED STATES             | aYwjDvsrOsH8kH5czOrT                     | 34-563-572-8955 | . express, pending frays snooze-- requests haggle even, even pains. carefully unusual
   1644616 | Customer#001644616 |  771292.69993603 |   1918.07 | RUSSIA                    | v9jjMLdv937T                             | 32-691-990-8179 | equests. slyly ironic pinto beans from the blithely express ideas boost accord
  11720725 | Customer#011720725 | 769750.407278745 |   8868.74 | ALGERIA                   | F7881jyecYQAgYlLCVfaGXoGpBMz hCfMJnRP    | 10-199-813-2782 | ges wake; furiously ironic courts sleep furiously ironic depos
  11601103 | Customer#011601103 | 766881.228046191 |   4454.88 | MOROCCO                   | 2VGmBkGh fxF1u,2,37BPIqC8MYLoC4pEyovoOz  | 25-234-262-7639 | ly. quickly final deposits x-ray fluffily final deposits. dugouts use busily. special packages wake about the slyl
   7543351 | Customer#007543351 | 763003.711314828 |   2286.72 | GERMANY                   | d2NVKX2wEQ22xuAwxpPLnWGqgq               | 17-997-642-3079 |  slyly slow platelets wake slyly about the unusual grouches.
  13121962 | Customer#013121962 | 762769.293390657 |   2688.81 | ETHIOPIA                  | 1xPdmUS8q7EAbgxCK6jwrBYfUCJPUe3vV5O3KH1  | 15-464-133-8490 | structions affix slyly silent packages? blithely unusual p
  11903764 | Customer#011903764 | 758387.003470712 |   9958.35 | MOZAMBIQUE                | U8MpGv6lSW7                              | 26-399-872-9412 | de of the blithely ironic accounts. slyly even theodolites use carefully. blithely unusual platelets arou
   8532673 | Customer#008532673 | 754356.556968453 |   2357.51 | KENYA                     | Spm iktvS72X8BY,                         | 24-426-216-4809 | iously-- blithely regular dugouts wake along the deposits. pending ideas maintain. slyly express foxes boost quick
   2493328 | Customer#002493328 | 753001.563825557 |   3692.77 | ARGENTINA                 | 2vHiKYz8wmKfmDguuXEj0Vx8HgI5             | 11-369-586-6787 | ptotes integrate slyly quickly ironic packages. blithely express theodolites n
  13645609 | Customer#013645609 | 749677.429058996 |   9741.69 | MOROCCO                   | In58FgVgVLwtJJkr                         | 25-508-461-1868 | en hockey players. requests cajole quickly express deposits. express, ironic requests haggle blithely. regul
(20 rows)

COMMIT;
COMMIT
