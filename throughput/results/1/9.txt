BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%olive%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2728676353.28031
 ALGERIA                   |   1997 |  4677553794.9539
 ALGERIA                   |   1996 | 4683846824.33745
 ALGERIA                   |   1995 | 4664502755.17411
 ALGERIA                   |   1994 | 4664284020.86731
 ALGERIA                   |   1993 | 4633803919.50142
 ALGERIA                   |   1992 | 4666595239.32744
 ARGENTINA                 |   1998 |  2692629138.4469
 ARGENTINA                 |   1997 | 4641876076.46731
 ARGENTINA                 |   1996 | 4670833454.54744
 ARGENTINA                 |   1995 | 4633316564.75522
 ARGENTINA                 |   1994 | 4630477766.45478
 ARGENTINA                 |   1993 | 4627939218.74261
 ARGENTINA                 |   1992 | 4636938514.92756
 BRAZIL                    |   1998 |  2732603549.0019
 BRAZIL                    |   1997 | 4672786563.88547
 BRAZIL                    |   1996 | 4652693271.81929
 BRAZIL                    |   1995 | 4686557193.58106
 BRAZIL                    |   1994 | 4661607532.60948
 BRAZIL                    |   1993 | 4674898024.95249
 BRAZIL                    |   1992 | 4673821816.86162
 CANADA                    |   1998 | 2725538954.02469
 CANADA                    |   1997 | 4660489684.62389
 CANADA                    |   1996 | 4653945591.09079
 CANADA                    |   1995 | 4667105443.26413
 CANADA                    |   1994 | 4646277303.92788
 CANADA                    |   1993 | 4658839801.66983
 CANADA                    |   1992 | 4678927387.68139
 CHINA                     |   1998 |  2714282259.1686
 CHINA                     |   1997 | 4653594054.64545
 CHINA                     |   1996 | 4658080312.79452
 CHINA                     |   1995 | 4660080271.32963
 CHINA                     |   1994 | 4621776899.40207
 CHINA                     |   1993 | 4661975605.34194
 CHINA                     |   1992 | 4657172280.24168
 EGYPT                     |   1998 | 2728920680.96416
 EGYPT                     |   1997 |  4658797831.1588
 EGYPT                     |   1996 | 4668627552.72743
 EGYPT                     |   1995 | 4663905264.48699
 EGYPT                     |   1994 |   4674909749.334
 EGYPT                     |   1993 | 4676750947.24747
 EGYPT                     |   1992 | 4682755801.64872
 ETHIOPIA                  |   1998 | 2749503024.43437
 ETHIOPIA                  |   1997 |  4674689005.6959
 ETHIOPIA                  |   1996 | 4668713965.23223
 ETHIOPIA                  |   1995 | 4678130162.98819
 ETHIOPIA                  |   1994 | 4691622910.70828
 ETHIOPIA                  |   1993 | 4684728040.07488
 ETHIOPIA                  |   1992 | 4683322655.92514
 FRANCE                    |   1998 | 2747745172.71213
 FRANCE                    |   1997 | 4671730953.53449
 FRANCE                    |   1996 | 4688679166.93474
 FRANCE                    |   1995 | 4685917293.81606
 FRANCE                    |   1994 | 4677859835.13933
 FRANCE                    |   1993 | 4694581890.79759
 FRANCE                    |   1992 | 4684724623.38761
 GERMANY                   |   1998 | 2743050264.70901
 GERMANY                   |   1997 | 4674187184.72893
 GERMANY                   |   1996 | 4702504928.39879
 GERMANY                   |   1995 | 4697045903.99642
 GERMANY                   |   1994 | 4654386852.97656
 GERMANY                   |   1993 | 4704234723.03046
 GERMANY                   |   1992 | 4716636813.72123
 INDIA                     |   1998 | 2746178431.05037
 INDIA                     |   1997 | 4677645546.59991
 INDIA                     |   1996 | 4683456916.52152
 INDIA                     |   1995 | 4677330562.07248
 INDIA                     |   1994 | 4663524610.55157
 INDIA                     |   1993 | 4673848061.33358
 INDIA                     |   1992 | 4671275764.23494
 INDONESIA                 |   1998 | 2705546694.54163
 INDONESIA                 |   1997 | 4640004166.78375
 INDONESIA                 |   1996 | 4625558785.97237
 INDONESIA                 |   1995 | 4614029311.32254
 INDONESIA                 |   1994 | 4644751076.68903
 INDONESIA                 |   1993 |  4607932620.4989
 INDONESIA                 |   1992 | 4636941654.05208
 IRAN                      |   1998 | 2720222367.27114
 IRAN                      |   1997 | 4664124473.77221
 IRAN                      |   1996 | 4660643674.93707
 IRAN                      |   1995 | 4640543439.99237
 IRAN                      |   1994 | 4664231511.13966
 IRAN                      |   1993 |  4653580740.8548
 IRAN                      |   1992 | 4685678438.44528
 IRAQ                      |   1998 | 2722949654.05902
 IRAQ                      |   1997 | 4646933417.29996
 IRAQ                      |   1996 | 4686550177.06083
 IRAQ                      |   1995 | 4682672292.55268
 IRAQ                      |   1994 | 4678046651.35521
 IRAQ                      |   1993 |  4652568978.1529
 IRAQ                      |   1992 | 4672779498.22173
 JAPAN                     |   1998 | 2715468467.06127
 JAPAN                     |   1997 | 4639104321.52863
 JAPAN                     |   1996 | 4673108798.49467
 JAPAN                     |   1995 | 4665856524.36093
 JAPAN                     |   1994 | 4635018538.47989
 JAPAN                     |   1993 | 4625301643.18628
 JAPAN                     |   1992 | 4633909860.66762
 JORDAN                    |   1998 | 2708713305.54553
 JORDAN                    |   1997 | 4610838444.06988
 JORDAN                    |   1996 | 4636674325.03696
 JORDAN                    |   1995 | 4623451202.73088
 JORDAN                    |   1994 | 4648658588.79744
 JORDAN                    |   1993 | 4642114390.72048
 JORDAN                    |   1992 | 4665589893.04478
 KENYA                     |   1998 | 2709441233.42471
 KENYA                     |   1997 | 4623562680.35295
 KENYA                     |   1996 | 4655505504.87365
 KENYA                     |   1995 | 4630099059.70097
 KENYA                     |   1994 | 4637878586.30675
 KENYA                     |   1993 | 4629171436.70008
 KENYA                     |   1992 | 4643648592.32324
 MOROCCO                   |   1998 | 2740491302.05701
 MOROCCO                   |   1997 | 4713474823.40859
 MOROCCO                   |   1996 | 4692855473.34045
 MOROCCO                   |   1995 | 4661349895.70101
 MOROCCO                   |   1994 | 4679249797.80851
 MOROCCO                   |   1993 |  4680978978.1982
 MOROCCO                   |   1992 | 4673576412.55584
 MOZAMBIQUE                |   1998 | 2736381597.92588
 MOZAMBIQUE                |   1997 | 4684606540.42341
 MOZAMBIQUE                |   1996 |  4674575887.6267
 MOZAMBIQUE                |   1995 |  4676733995.9986
 MOZAMBIQUE                |   1994 |  4656936792.4781
 MOZAMBIQUE                |   1993 | 4659690250.79323
 MOZAMBIQUE                |   1992 | 4658765135.78631
 PERU                      |   1998 | 2700483285.69314
 PERU                      |   1997 | 4637705375.48678
 PERU                      |   1996 |  4669791982.8558
 PERU                      |   1995 | 4628287778.75903
 PERU                      |   1994 | 4637567706.91018
 PERU                      |   1993 | 4613368803.25029
 PERU                      |   1992 | 4645249962.99987
 ROMANIA                   |   1998 | 2747077910.98344
 ROMANIA                   |   1997 | 4672721727.06741
 ROMANIA                   |   1996 | 4690276094.13464
 ROMANIA                   |   1995 | 4678129776.39517
 ROMANIA                   |   1994 | 4673068428.98533
 ROMANIA                   |   1993 | 4661237518.82306
 ROMANIA                   |   1992 | 4685880297.71336
 RUSSIA                    |   1998 |  2711848725.9323
 RUSSIA                    |   1997 | 4624825651.35347
 RUSSIA                    |   1996 |  4636650106.2254
 RUSSIA                    |   1995 | 4640781902.42802
 RUSSIA                    |   1994 | 4653659686.04819
 RUSSIA                    |   1993 | 4648493152.57576
 RUSSIA                    |   1992 | 4631730089.32177
 SAUDI ARABIA              |   1998 | 2712710402.40493
 SAUDI ARABIA              |   1997 | 4663624593.44306
 SAUDI ARABIA              |   1996 | 4660908721.62436
 SAUDI ARABIA              |   1995 | 4662326333.78748
 SAUDI ARABIA              |   1994 | 4649247913.04457
 SAUDI ARABIA              |   1993 | 4641945119.23781
 SAUDI ARABIA              |   1992 | 4645082274.77627
 UNITED KINGDOM            |   1998 | 2770572489.60947
 UNITED KINGDOM            |   1997 | 4764051914.60195
 UNITED KINGDOM            |   1996 | 4729201910.37517
 UNITED KINGDOM            |   1995 | 4723715592.76417
 UNITED KINGDOM            |   1994 | 4706877531.67311
 UNITED KINGDOM            |   1993 | 4703415282.94539
 UNITED KINGDOM            |   1992 | 4742554236.88366
 UNITED STATES             |   1998 | 2741811731.29531
 UNITED STATES             |   1997 | 4673451067.71768
 UNITED STATES             |   1996 | 4668516083.23445
 UNITED STATES             |   1995 | 4652560518.21687
 UNITED STATES             |   1994 | 4643522349.81517
 UNITED STATES             |   1993 | 4686762650.19612
 UNITED STATES             |   1992 | 4680760984.43655
 VIETNAM                   |   1998 | 2735348335.10112
 VIETNAM                   |   1997 | 4690401226.66444
 VIETNAM                   |   1996 |  4710417279.0132
 VIETNAM                   |   1995 | 4693986903.17257
 VIETNAM                   |   1994 | 4693105959.95854
 VIETNAM                   |   1993 | 4701224328.93942
 VIETNAM                   |   1992 |  4692647047.9441
(175 rows)

COMMIT;
COMMIT
